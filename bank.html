<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¡é’±ä»»åŠ¡ä¸­å¿ƒ</title>
    <script src="https://kit.fontawesome.com/a2e0e6ad62.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <style>
        /* ===================================================
           File: bank.html (æ¡é’±ä»»åŠ¡ä¸­å¿ƒ)
           Author: Gary Geng
           Last Update: 2025-11-10
           Description: æ˜¾ç¤ºæŒ‰é“¶è¡Œåˆ†ç±»çš„æ´»åŠ¨åˆ—è¡¨ + å€’è®¡æ—¶ + ç­›é€‰åŠŸèƒ½
           =================================================== */

        body {
            background-color: #0B1120;
            color: #E0E7FF;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
        }

        .bank-card {
            background-color: #1E293B;
            border: 1px solid #334155;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
            position: relative;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: transform 0.2s ease;
        }
        .bank-card:hover {
            transform: translateY(-3px);
        }

        .category-header {
            background-color: #334155;
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            margin: 1.5rem 0 1rem 0;
            display: flex;
            align-items: center;
            font-weight: 600;
            border-left: 4px solid #60A5FA;
        }

        .filter-bar {
            display: flex;
            overflow-x: auto;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .filter-bar::-webkit-scrollbar {
            display: none;
        }

        .filter-button {
            background-color: #1E293B;
            border: 1px solid #475569;
            color: #E0E7FF;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            white-space: nowrap;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .filter-button:hover {
            background-color: #334155;
        }
        .filter-button.active {
            background-color: #3B82F6;
            border-color: #60A5FA;
            color: white;
        }

        .countdown-badge {
            position: absolute;
            top: 6px;
            right: 8px;
            background-color: #10B981;
            color: white;
            border-radius: 9999px;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }
        .countdown-badge.expired {
            background-color: #EF4444;
        }

        .back-arrow-link {
            display: flex;
            align-items: center;
            background-color: #1E293B;
            color: #E0E7FF;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 1.5rem;
            width: fit-content;
        }
        .back-arrow-link:hover {
            background-color: #1E2B44;
        }

        .action-button {
            background-color: #3B82F6;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            transition: background-color 0.2s ease;
        }
        .action-button:hover {
            background-color: #2563EB;
        }
        .action-button:active {
            transform: scale(0.95);
        }

        @keyframes fade-in { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:none;} }
        .animate-fade-in { animation: fade-in 0.3s ease forwards; }
    </style>
</head>

<body class="p-4">

    <!-- è¿”å›æŒ‰é’® -->
    <a href="checkin.html" class="back-arrow-link">
        <i class="fas fa-arrow-left mr-2"></i> è¿”å›ç­¾åˆ°ä¸­å¿ƒ
    </a>

    <!-- é¡µæ ‡é¢˜ -->
    <h1 class="text-3xl font-bold mb-4 text-center text-blue-400">ğŸ’° æ¡é’±ä»»åŠ¡ä¸­å¿ƒ</h1>
    <p class="text-center text-gray-400 mb-6">ç­›é€‰é“¶è¡Œæ´»åŠ¨ï¼ŒæŸ¥çœ‹ä»»åŠ¡å€’è®¡æ—¶ï¼Œè½»æ¾èµšé’±ï¼</p>

    <!-- ç­›é€‰æ¡ -->
    <div id="bank-filters" class="filter-bar"></div>

    <!-- åˆ†ç±»åŒºåŸŸ -->
    <main>
        <section>
            <h2 class="category-header"><i class="fas fa-coins text-yellow-400 mr-2"></i> æ—¥å¸¸ä»»åŠ¡</h2>
            <div id="routine-list"></div>
        </section>
        <section>
            <h2 class="category-header"><i class="fas fa-credit-card text-green-400 mr-2"></i> æ”¯ä»˜ä»»åŠ¡</h2>
            <div id="payment-list"></div>
        </section>
        <section>
            <h2 class="category-header"><i class="fas fa-piggy-bank text-pink-400 mr-2"></i> å‚¨è“„ä»»åŠ¡</h2>
            <div id="savings-list"></div>
        </section>
    </main>

    <script>
        // æ¨¡æ‹Ÿæ´»åŠ¨æ•°æ®
        const MOCK_ACTIVITIES = [
            { title: "æ”¯ä»˜å®æ¶ˆè´¹èµ¢çº¢åŒ…", bank: "æ”¯ä»˜å®", category: "payment", start: "2025-11-10", end: "2025-11-25", link: "https://www.alipay.com" },
            { title: "å¾®ä¿¡æ­¥æ•°è¾¾æ ‡é¢†ç°é‡‘", bank: "å¾®ä¿¡", category: "routine", start: "2025-11-08", end: "2025-11-15", link: "https://www.wechat.com" },
            { title: "å»ºè®¾é“¶è¡Œç†è´¢è¿”ç°æ´»åŠ¨", bank: "å»ºè®¾é“¶è¡Œ", category: "savings", start: "2025-11-01", end: "2025-11-20", link: "#" },
            { title: "æ‹›å•†é“¶è¡Œä¿¡ç”¨å¡æ”¯ä»˜è¿”ç°", bank: "æ‹›å•†é“¶è¡Œ", category: "payment", start: "2025-11-05", end: "2025-11-18", link: "#" },
            { title: "å·¥å•†é“¶è¡Œæ¯æ—¥ç­¾åˆ°èµšç§¯åˆ†", bank: "å·¥å•†é“¶è¡Œ", category: "routine", start: "2025-11-09", end: "2025-11-30", link: "#" },
            { title: "äº¤é€šé“¶è¡Œå‚¨è“„å¥–åŠ±è®¡åˆ’", bank: "äº¤é€šé“¶è¡Œ", category: "savings", start: "2025-11-01", end: "2025-11-19", link: "#" }
        ];

        let selectedBank = null;

        // è·å–é“¶è¡Œå›¾æ ‡
        function getBankIcon(bankName) {
            const map = {
                'å¾®ä¿¡': 'fab fa-weixin',
                'æ”¯ä»˜å®': 'fab fa-alipay',
                'å»ºè®¾': 'fa-landmark',
                'æ‹›å•†': 'fa-star',
                'å·¥å•†': 'fa-briefcase',
                'äº¤é€š': 'fa-route'
            };
            for (const [k, v] of Object.entries(map)) {
                if (bankName.includes(k)) return v;
            }
            return 'fa-university';
        }

        // åˆå§‹åŒ–ç­›é€‰æ¡
        function initBankFilters(activities) {
            const filtersContainer = document.getElementById('bank-filters');
            filtersContainer.innerHTML = '';
            const banks = [...new Set(activities.map(a => a.bank))];

            const allButton = document.createElement('button');
            allButton.className = 'filter-button active';
            allButton.textContent = 'å…¨éƒ¨æ´»åŠ¨';
            allButton.onclick = () => {
                selectedBank = null;
                document.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
                allButton.classList.add('active');
                renderActivities(activities);
            };
            filtersContainer.appendChild(allButton);

            banks.forEach(bank => {
                const button = document.createElement('button');
                button.className = 'filter-button';
                button.textContent = bank;
                button.onclick = () => {
                    selectedBank = bank;
                    document.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    renderActivities(activities.filter(a => a.bank === bank));
                };
                filtersContainer.appendChild(button);
            });
        }

        // æ¸²æŸ“æ´»åŠ¨å¡ç‰‡
        function renderActivities(activities) {
            const categories = {
                routine: document.getElementById('routine-list'),
                payment: document.getElementById('payment-list'),
                savings: document.getElementById('savings-list')
            };
            Object.values(categories).forEach(c => c.innerHTML = '');

            let hasActivities = false;
            activities.forEach(act => {
                if (!categories[act.category]) return;
                hasActivities = true;
                const icon = getBankIcon(act.bank);
                const card = `
                    <div class="bank-card animate-fade-in">
                        <div class="flex items-center mb-2">
                            <i class="${icon} text-xl mr-2 text-blue-400"></i>
                            <h3 class="text-lg font-semibold flex-1">${act.title}</h3>
                        </div>
                        <p class="text-gray-400 text-sm mb-2">${act.bank}</p>
                        <p class="text-xs text-gray-500 mb-2">æ´»åŠ¨æ—¶é—´ï¼š${act.start} ~ ${act.end}</p>
                        <div class="countdown-badge" data-endtime="${act.end}"></div>
                        <a href="${act.link}" class="action-button mt-2 inline-block" target="_blank">ç«‹å³å‚ä¸</a>
                    </div>`;
                categories[act.category].innerHTML += card;
            });

            if (!hasActivities) {
                Object.values(categories).forEach(c => {
                    c.innerHTML = '<p class="text-gray-500 text-center mt-4">è¯¥åˆ†ç±»ä¸‹æ²¡æœ‰æ´»åŠ¨ã€‚</p>';
                });
            }

            updateAllCountdowns();
        }

        // å€’è®¡æ—¶è®¡ç®—
        function getRemainingTime(endDate, badge) {
            const now = new Date();
            const end = new Date(endDate);
            const diff = end - now;
            if (diff <= 0) {
                badge.textContent = "å·²ç»“æŸ";
                badge.classList.add('expired');
                return;
            }
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((diff / (1000 * 60)) % 60);
            const seconds = Math.floor((diff / 1000) % 60);

            badge.textContent = days > 0
                ? `å‰©ä½™ ${days}å¤© ${hours}å°æ—¶`
                : `å‰©ä½™ ${hours}å°æ—¶ ${minutes}åˆ† ${seconds}ç§’`;
        }

        // å¾ªç¯åˆ·æ–°å€’è®¡æ—¶
        function updateAllCountdowns() {
            document.querySelectorAll('.countdown-badge').forEach(badge => {
                const endDate = badge.getAttribute('data-endtime');
                if (endDate) getRemainingTime(endDate, badge);
            });
        }

        function startCountdownUpdater() {
            updateAllCountdowns();
            setInterval(updateAllCountdowns, 1000);
        }

        // ä¸»å¯åŠ¨å‡½æ•°
        document.addEventListener('DOMContentLoaded', () => {
            initBankFilters(MOCK_ACTIVITIES);
            renderActivities(MOCK_ACTIVITIES);
            startCountdownUpdater();
        });
    </script>
</body>
</html>
